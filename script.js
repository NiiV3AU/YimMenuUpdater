function toggleAccordion(headerElement){const contentElement=headerElement.nextElementSibling;const parentItem=headerElement.parentElement;if(!contentElement||!(contentElement.classList.contains("changelog-details")||contentElement.classList.contains("faq-answer"))){console.error("Accordion content not found for:",headerElement);return}if(!parentItem||!(parentItem.classList.contains("changelog-item")||parentItem.classList.contains("faq-item"))){console.warn("Accordion parent item not found for:",headerElement)}const isCollapsed=contentElement.classList.contains("collapsed");contentElement.style.willChange="opacity";const cleanupAnimation=(event)=>{if(event.target===contentElement){contentElement.style.willChange="auto"}};contentElement.removeEventListener("transitionend",cleanupAnimation);contentElement.addEventListener("transitionend",cleanupAnimation,{once:true});requestAnimationFrame(()=>{if(isCollapsed){contentElement.classList.remove("collapsed");if(parentItem){parentItem.classList.add("is-open")}}else{contentElement.classList.add("collapsed");if(parentItem){parentItem.classList.remove("is-open")}}})}document.addEventListener("DOMContentLoaded",()=>{const langToggleButton=document.getElementById("lang-toggle-btn");const translatableElements=document.querySelectorAll("[data-translate]");const htmlElement=document.documentElement;const setLanguage=(lang)=>{translatableElements.forEach((element)=>{const enText=element.dataset.langEn;const deText=element.dataset.langDe;let textToSet;if(lang==="en"){textToSet=enText&&enText.trim()!==""?enText:deText&&deText.trim()!==""?deText:undefined}else{textToSet=deText&&deText.trim()!==""?deText:enText&&enText.trim()!==""?enText:undefined}if(textToSet){element.textContent=textToSet}else{const hasEnData=element.hasAttribute("data-lang-en");const hasDeData=element.hasAttribute("data-lang-de");if(hasEnData&&(!enText||enText.trim()==="")&&hasDeData&&(!deText||deText.trim()==="")){console.warn(`Both language attributes are present but empty for element in lang '${ lang }':`,element)}else if(!hasEnData&&!hasDeData){console.warn(`No data-lang-en or data-lang-de attributes found for element:`,element)}else{console.warn(`No suitable non-empty translation found for element in lang '${ lang }' (check data attributes):`,element)}}});htmlElement.setAttribute("lang",lang);if(langToggleButton){if(lang==="en"){langToggleButton.innerHTML="&#127482;&#127480;";langToggleButton.classList.add("show-us-flag-bg");langToggleButton.classList.remove("show-de-flag-bg")}else{langToggleButton.innerHTML="&#127465;&#127466;";langToggleButton.classList.add("show-de-flag-bg");langToggleButton.classList.remove("show-us-flag-bg")}}try{localStorage.setItem("preferredLanguage",lang)}catch(e){console.error("Could not save language preference to localStorage.",e)}};const toggleLanguage=()=>{const currentLang=htmlElement.getAttribute("lang")||"en";const newLang=currentLang==="de"?"en":"de";setLanguage(newLang)};if(langToggleButton){langToggleButton.addEventListener("click",toggleLanguage)}else{console.warn("Language toggle button not found.")}let initialLang="en";try{const savedLang=localStorage.getItem("preferredLanguage");if(savedLang&&(savedLang==="de"||savedLang==="en")){initialLang=savedLang}else{const browserLang=navigator.language||navigator.userLanguage;if(browserLang&&browserLang.toLowerCase().startsWith("de")){initialLang="de"}else{}}}catch(e){console.error("Error accessing localStorage or navigator.language:",e)}setLanguage(initialLang);const menuToggle=document.querySelector(".mobile-menu-toggle");const mainNav=document.querySelector("#main-navigation");if(menuToggle&&mainNav){menuToggle.addEventListener("click",()=>{mainNav.classList.toggle("is-open");menuToggle.classList.toggle("is-active");const isExpanded=menuToggle.getAttribute("aria-expanded")==="true";menuToggle.setAttribute("aria-expanded",!isExpanded)});mainNav.querySelectorAll("a").forEach((link)=>{link.addEventListener("click",()=>{if(mainNav.classList.contains("is-open")){mainNav.classList.remove("is-open");menuToggle.classList.remove("is-active");menuToggle.setAttribute("aria-expanded","false")}})})}else{console.warn("Mobile menu toggle button or main navigation not found.")}const githubUser="NiiV3AU";const githubRepo="YMU";const textElementId="github-downloads";const badgeElementId="github-downloads-badge";const cacheKey=`github_downloads_${ githubUser }_${ githubRepo }`;const cacheDurationMinutes=5;async function displayGitHubDownloads(){const textElement=document.getElementById(textElementId);const badgeElement=document.getElementById(badgeElementId);if(!textElement||!badgeElement){console.error(`Elements for text (${ textElementId }) or badge (${ badgeElementId }) not found.`);return}const showFallbackBadge=()=>{console.warn("Fallback to Badge activated.");textElement.style.display="none";badgeElement.src=`https://badgen.net/github/assets-dl/${ githubUser }/${ githubRepo }?label=&labelColor=black&color=black&cache=300`;badgeElement.style.display="inline"};const cachedData=sessionStorage.getItem(cacheKey);let totalDownloadsText="N/A";if(cachedData){try{const{count,timestamp}=JSON.parse(cachedData);const ageMinutes=(Date.now()-timestamp)/(1000*60);if(ageMinutes<cacheDurationMinutes){console.log("Using cached download count:",count);textElement.textContent=count.toLocaleString();textElement.style.display="inline";badgeElement.style.display="none";return}else{console.log("Cache expired.")}}catch(e){console.error("Error parsing cached data:",e)}}console.log("Fetching download count from GitHub API...");textElement.textContent="...";textElement.style.display="inline";badgeElement.style.display="none";const apiUrl=`https://api.github.com/repos/${ githubUser }/${ githubRepo }/releases/latest`;try{const response=await fetch(apiUrl);if(!response.ok){console.error(`GitHub API Error: ${response.status } ${response.statusText }`);showFallbackBadge();return}const latestRelease=await response.json();let currentTotal=0;if(latestRelease&&latestRelease.assets&&latestRelease.assets.length>0){latestRelease.assets.forEach((asset)=>{currentTotal+=asset.download_count});totalDownloadsText=currentTotal.toLocaleString();try{sessionStorage.setItem(cacheKey,JSON.stringify({count:currentTotal,timestamp:Date.now()}));console.log("Saved download count to cache.")}catch(e){console.error("Error saving data to cache:",e)}}else{console.log("No assets found in the latest release, or latest release endpoint returned no data.");totalDownloadsText="N/A"}textElement.textContent=totalDownloadsText;textElement.style.display="inline";badgeElement.style.display="none"}catch(error){console.error("Network or other error fetching downloads:",error);showFallbackBadge()}}displayGitHubDownloads();const downloadButton=document.getElementById("download-btn-main");const downloadCountDisplay=document.getElementById("github-downloads");let visualIncrementDone=false;if(downloadButton&&downloadCountDisplay){downloadButton.addEventListener("click",(event)=>{if(!visualIncrementDone){const currentText=downloadCountDisplay.textContent;const currentCount=parseInt(currentText.replace(/[,.]/g,""),10);if(!isNaN(currentCount)){const newCount=currentCount+1;downloadCountDisplay.textContent=newCount.toLocaleString();visualIncrementDone=true;if(downloadCountDisplay){downloadCountDisplay.classList.add("count-updated");downloadCountDisplay.addEventListener("animationend",()=>{downloadCountDisplay.classList.remove("count-updated")},{once:true})}}else{console.log("Current download counter is not a number ('"+currentText+"'), visual increment skipped.")}}else{console.log("Visual increase already carried out.")}})}else{console.warn("Download button (#download-btn-main) or counter display (#github-downloads) not found for visual increase.")}function addCloudflareAnalytics(siteToken){const script=document.createElement("script");script.defer=true;script.dataset.cfBeacon=`{"token": "${ siteToken }"}`;script.src="https://static.cloudflareinsights.com/beacon.min.js";document.body.appendChild(script);console.log(`Cloudflare Web Analytics for GitHub Pages (Token: ${ siteToken }) added to body.`)}const currentHostname=window.location.hostname;const githubPagesHostname="niiv3au.github.io";const githubPagesAnalyticsToken="e759315bc30b49adb382b087660536e2";if(currentHostname===githubPagesHostname){addCloudflareAnalytics(githubPagesAnalyticsToken)}});
